# React Fiber

[React æŠ€æœ¯æ­ç§˜](https://react.iamkasong.com/) ğŸŒŸ

> - [å‡½æ•°å¼ç»„ä»¶ä¸ç±»ç»„ä»¶æœ‰ä½•ä¸åŒ](https://overreacted.io/zh-hans/how-are-function-components-different-from-classes/)
> - [useEffect å®Œæ•´æŒ‡å—](https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/)


## å¦‚ä½•ç†è§£ Fiber åŠ Time Sliceï¼Ÿ

**React Fiber æ˜¯ä¸€ç§åŸºäºæµè§ˆå™¨çš„å•çº¿ç¨‹è°ƒåº¦ç®—æ³•ï¼š**

React 16 ä¹‹å‰ ï¼Œ`reconcilation` ç®—æ³•å®é™…ä¸Šæ˜¯é€’å½’ï¼Œæƒ³è¦ä¸­æ–­é€’å½’æ˜¯å¾ˆå›°éš¾çš„ã€‚å¦‚æœä½ æ‹¥æœ‰ä¸€ä¸ªå¾ˆå¤æ‚çš„å¤åˆç»„ä»¶ï¼Œç„¶åæ”¹åŠ¨äº†æœ€ä¸Šå±‚ç»„ä»¶çš„ `state`ï¼Œé‚£ä¹ˆè°ƒç”¨æ ˆå¯èƒ½ä¼šå¾ˆé•¿ã€‚è°ƒç”¨æ ˆè¿‡é•¿ï¼Œå†åŠ ä¸Šä¸­é—´è¿›è¡Œäº†å¤æ‚çš„æ“ä½œï¼Œå°±å¯èƒ½å¯¼è‡´é•¿æ—¶é—´é˜»å¡ä¸»çº¿ç¨‹ï¼Œå¸¦æ¥ä¸å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

åœ¨ React V16 ç‰ˆæœ¬ä¸­å¼•å…¥äº† Fiber æœºåˆ¶ä½¿ç”¨å¾ªç¯æ¥ä»£æ›¿ä¹‹å‰çš„é€’å½’ç®—æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™ä¸ªæœºåˆ¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šçš„å½±å“äº†éƒ¨åˆ†ç”Ÿå‘½å‘¨æœŸçš„è°ƒç”¨ï¼Œå¹¶ä¸”ä¹Ÿå¼•å…¥äº†æ–°çš„ 2 ä¸ª API æ¥è§£å†³é—®é¢˜ã€‚

**`Fiber`ï¼šä¸€ç§å°† `recocilation` ï¼ˆé€’å½’ diffï¼‰ï¼Œæ‹†åˆ†æˆæ— æ•°ä¸ªå°ä»»åŠ¡çš„ç®—æ³•ï¼›å®ƒéšæ—¶èƒ½å¤Ÿåœæ­¢ï¼Œæ¢å¤ã€‚åœæ­¢æ¢å¤çš„æ—¶æœºå–å†³äºå½“å‰çš„ä¸€å¸§ï¼ˆ16msï¼‰å†…ï¼Œè¿˜æœ‰æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´å…è®¸è®¡ç®—ã€‚**

**Time Slice æ—¶é—´åˆ†ç‰‡ï¼š** 

![Fiber åˆ†æ®µç¤ºæ„å›¾](../Images/react/fiber.png)

Fiber æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„å †æ ˆå¸§ï¼Œæ–°çš„è°ƒåº¦å™¨ä¼šæŒ‰ç…§ä¼˜å…ˆçº§è‡ªç”±è°ƒåº¦è¿™äº›å¸§ï¼Œä»è€Œå°†ä¹‹å‰çš„åŒæ­¥æ¸²æŸ“æ”¹æˆäº†å¼‚æ­¥æ¸²æŸ“ï¼Œåœ¨ä¸å½±å“ä½“éªŒçš„æƒ…å†µä¸‹å»åˆ†æ®µè®¡ç®—æ›´æ–°ã€‚æ—¶é—´åˆ†ç‰‡æ­£æ˜¯åŸºäºå¯éšæ—¶æ‰“æ–­ã€é‡å¯çš„ Fiber æ¶æ„ï¼Œå¯æ‰“æ–­å½“å‰ä»»åŠ¡ï¼Œä¼˜å…ˆå¤„ç†ç´§æ€¥ä¸”é‡è¦çš„ä»»åŠ¡ï¼Œä¿è¯é¡µé¢çš„æµç•…è¿è¡Œã€‚

> å¯¹äºå¦‚ä½•åŒºåˆ«ä¼˜å…ˆçº§ï¼ŒReact æœ‰è‡ªå·±çš„ä¸€å¥—é€»è¾‘ã€‚
>
> 1. å¯¹äºåŠ¨ç”»è¿™ç§å®æ—¶æ€§å¾ˆé«˜çš„ä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯ 16 ms å¿…é¡»æ¸²æŸ“ä¸€æ¬¡ä¿è¯ä¸å¡é¡¿çš„æƒ…å†µä¸‹ï¼ŒReact ä¼šæ¯ 16 msï¼ˆä»¥å†…ï¼‰ æš‚åœä¸€ä¸‹æ›´æ–°ï¼Œè¿”å›æ¥ç»§ç»­æ¸²æŸ“åŠ¨ç”»
> 2. æ ¹æ®äº‹ä»¶ç±»å‹æ¥ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œç‚¹å‡»äº‹ä»¶ã€ç”¨æˆ·è¾“å…¥äº‹ä»¶ï¼Œç›¸æ¯”æ»šåŠ¨äº‹ä»¶çš„ä¼˜å…ˆçº§è¦é«˜ ã€‚ç›®å‰ React å†…éƒ¨äº‹ä»¶æœºåˆ¶æœ‰ç®€å•åŒºåˆ†ä¼˜å…ˆçº§
> 3. äººå·¥æç¤º Reactã€‚å‚è€ƒå®éªŒç‰ˆæœ¬é‡Œé¢çš„ useTransitionï¼ŒuseDeferredValue  
> 4. éšè—å†…å®¹çš„æ›´æ–°ä¼˜å…ˆçº§æœ€ä½ã€‚è¿™é€šå¸¸ä¹Ÿéœ€è¦æç¤º React æŒ‡å®šç»„ä»¶æ˜¯éšè—çš„ï¼Œç›®å‰æ²¡æœ‰å…¬å¼€ API

> æ¨èé˜…è¯»ï¼š[è¿™å¯èƒ½æ˜¯æœ€é€šä¿—çš„ React Fiberï¼ˆæ—¶é—´åˆ†ç‰‡ï¼‰ æ‰“å¼€æ–¹å¼](https://juejin.im/post/5dadc6045188255a270a0f85) 
